<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no">
  <title>SpiceCraft Kitchen - Food Ordering</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>
  <style>
    * {
      font-family: 'Poppins', sans-serif;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    html, body {
      height: 100%;
      width: 100%;
      margin: 0;
      padding: 0;
      background: #0D0D0D;
      overflow: hidden;
    }

    .app-wrapper {
      width: 100%;
      height: 100%;
      background: #0D0D0D;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      overflow: hidden;
    }

    @media (min-width: 768px) {
      .app-wrapper {
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        padding: 16px;
        overflow-y: auto;
      }
    }

    .phone-frame {
      width: 100%;
      height: 100%;
      max-width: 100%;
      max-height: 100%;
      border-radius: 0;
      border: none;
      overflow: hidden;
      position: relative;
      background: #0D0D0D;
      display: flex;
      flex-direction: column;
      will-change: transform;
    }

    @media (min-width: 768px) {
      .phone-frame {
        width: 420px;
        height: auto;
        max-height: 90vh;
        border-radius: 40px;
        border: 8px solid #2a2a2a;
        box-shadow: 0 50px 100px rgba(0,0,0,0.5), inset 0 0 0 2px #444;
      }

      .phone-frame::before {
        content: '';
        position: absolute;
        top: 8px;
        left: 50%;
        transform: translateX(-50%);
        width: 80px;
        height: 24px;
        background: #1a1a1a;
        border-radius: 20px;
        z-index: 100;
      }
    }

    .phone-content {
      background: #0D0D0D;
      width: 100%;
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      padding-bottom: 140px;
      -webkit-overflow-scrolling: touch;
      scroll-behavior: smooth;
      will-change: scroll-position;
    }

    @media (min-width: 768px) {
      .phone-content {
        padding-top: 35px;
        padding-bottom: 120px;
      }
    }

    .hide-scrollbar::-webkit-scrollbar {
      display: none;
    }

    .hide-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    .category-pill {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      white-space: nowrap;
      will-change: background, color;
    }

    .category-pill.active {
      background: #A8E63D !important;
      color: #0D0D0D !important;
      transform: scale(1.05);
    }

    .food-card {
      animation: slideUp 0.3s ease forwards;
      opacity: 0;
      transform: translateY(20px);
      will-change: transform, opacity;
    }

    @keyframes slideUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes cardHover {
      0%, 100% {
        box-shadow: 0 0 5px rgba(168, 230, 61, 0.3);
      }
      50% {
        box-shadow: 0 0 20px rgba(168, 230, 61, 0.6), 0 0 40px rgba(168, 230, 61, 0.3);
      }
    }

    .food-card:hover {
      animation: cardHover 1.5s ease-in-out infinite, slideUp 0.3s ease forwards;
    }

    .cart-sheet {
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      will-change: transform;
    }

    .cart-sheet.open {
      transform: translateY(0);
    }

    .backdrop {
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      pointer-events: none;
      will-change: opacity;
    }

    .backdrop.open {
      opacity: 1;
      visibility: visible;
      pointer-events: auto;
    }

    @keyframes marquee {
      0% {
        transform: translateX(100%);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    .marquee-text {
      animation: marquee 15s linear infinite;
      will-change: transform;
    }

    .toast {
      animation: toastIn 0.3s ease, toastOut 0.3s ease 2.7s forwards;
    }

    @keyframes toastIn {
      from {
        transform: translateY(100px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    @keyframes toastOut {
      from {
        transform: translateY(0);
        opacity: 1;
      }
      to {
        transform: translateY(100px);
        opacity: 0;
      }
    }

    .bottom-bar {
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      animation: cartGlow 3s ease-in-out infinite;
      will-change: transform;
    }

    .bottom-bar.visible {
      transform: translateY(0);
    }

    @keyframes cartGlow {
      0%, 100% {
        box-shadow: 0 -4px 20px rgba(168, 230, 61, 0.1);
      }
      50% {
        box-shadow: 0 -4px 30px rgba(168, 230, 61, 0.25);
      }
    }

    @keyframes bounce {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.3);
      }
    }

    .cart-bounce {
      animation: bounce 0.3s ease;
    }

    .add-btn {
      transition: all 0.2s ease;
      will-change: transform;
    }

    .add-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px rgba(168, 230, 61, 0.5);
    }

    .add-btn:active {
      transform: scale(0.95);
    }

    .qty-container {
      display: flex;
      align-items: center;
      gap: 6px;
      background: rgba(168, 230, 61, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 50px;
      padding: 4px 6px;
      box-shadow: 0 8px 32px rgba(168, 230, 61, 0.2), inset 0 1px 0 rgba(255,255,255,0.3);
      border: 1px solid rgba(255,255,255,0.2);
      will-change: transform;
    }

    .qty-btn {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: rgba(13, 13, 13, 0.3);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.15);
      color: #0D0D0D;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255,255,255,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      will-change: transform;
    }

    .qty-btn:active {
      transform: scale(0.85);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255,255,255,0.1);
    }

    .qty-display {
      color: #0D0D0D;
      font-weight: 700;
      font-size: 14px;
      min-width: 22px;
      text-align: center;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
    }

    .whatsapp-btn {
      background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
      transition: all 0.3s ease;
      will-change: transform;
    }

    .whatsapp-btn:hover {
      transform: scale(1.02);
      box-shadow: 0 10px 30px rgba(37, 211, 102, 0.3);
    }

    .whatsapp-btn:active {
      transform: scale(0.98);
    }

    .dish-name {
      font-size: 16px;
      font-weight: 700;
      letter-spacing: -0.3px;
      line-height: 1.2;
    }

    .dish-price {
      font-size: 15px;
      font-weight: 600;
    }

    .rating-text {
      font-size: 12px;
      font-weight: 400;
    }

    .meta-info {
      font-size: 11px;
      font-weight: 500;
    }

    @keyframes successCheckmark {
      0% {
        transform: scale(0) rotate(-45deg);
        opacity: 0;
      }
      50% {
        transform: scale(1.2);
      }
      100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
      }
    }

    @keyframes successPulse {
      0% {
        transform: scale(1);
        opacity: 0.8;
      }
      100% {
        transform: scale(1.8);
        opacity: 0;
      }
    }

    .success-overlay {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      pointer-events: none;
    }

    .success-icon {
      width: 80px;
      height: 80px;
      background: #A8E63D;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
      animation: successCheckmark 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
      box-shadow: 0 20px 60px rgba(168, 230, 61, 0.4);
      position: relative;
      will-change: transform;
    }

    .success-pulse {
      position: absolute;
      width: 80px;
      height: 80px;
      border-radius: 50%;
      border: 2px solid #A8E63D;
      animation: successPulse 0.8s ease-out forwards;
      will-change: transform;
    }

    .cart-thumbnail-stack {
      display: flex;
      align-items: center;
      gap: -8px;
      position: relative;
    }

    .cart-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.3);
      object-fit: cover;
      margin-left: -8px;
    }

    .cart-thumb:first-child {
      margin-left: 0;
    }

    .cart-thumb-count {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: rgba(168, 230, 61, 0.9);
      border: 2px solid rgba(255,255,255,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: 700;
      color: #0D0D0D;
      margin-left: -8px;
    }

    .payment-option {
      transition: all 0.2s ease;
    }

    .payment-option.selected {
      border-color: #A8E63D !important;
      background: rgba(168, 230, 61, 0.1) !important;
    }

    .barcode-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      backdrop-filter: blur(5px);
      animation: fadeIn 0.3s ease;
    }

    .barcode-modal.open {
      display: flex;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    .barcode-content {
      background: #1A1A1A;
      border-radius: 20px;
      padding: 24px;
      text-align: center;
      max-width: 90%;
      border: 2px solid #A8E63D;
      box-shadow: 0 20px 60px rgba(168, 230, 61, 0.3);
      animation: slideUp 0.4s ease;
      max-height: 80vh;
      overflow-y: auto;
    }

    .barcode-content svg {
      max-width: 100%;
      height: auto;
      margin: 20px 0;
    }

    .payment-processing {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.95);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 3000;
      flex-direction: column;
      gap: 20px;
    }

    .payment-processing.show {
      display: flex;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(168, 230, 61, 0.2);
      border-top-color: #A8E63D;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .size-selector {
      display: flex;
      gap: 8px;
      margin-top: 8px;
      flex-wrap: wrap;
    }

    .size-option {
      padding: 6px 12px;
      border-radius: 20px;
      border: 2px solid #333;
      background: #1A1A1A;
      color: #999;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .size-option:hover {
      border-color: #A8E63D;
      color: #A8E63D;
    }

    .size-option.selected {
      background: #A8E63D;
      color: #0D0D0D;
      border-color: #A8E63D;
    }

    .size-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      backdrop-filter: blur(5px);
      padding: 20px;
    }

    .size-modal.open {
      display: flex;
    }

    .size-modal-content {
      background: #1A1A1A;
      border-radius: 20px;
      padding: 24px;
      max-width: 300px;
      border: 2px solid #A8E63D;
      box-shadow: 0 20px 60px rgba(168, 230, 61, 0.3);
      animation: slideUp 0.4s ease;
      text-align: center;
    }

    .size-modal-content h3 {
      color: white;
      margin-bottom: 16px;
      font-size: 18px;
    }

    .size-options-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 16px;
    }

    .size-btn {
      padding: 12px;
      border-radius: 12px;
      border: 2px solid #333;
      background: #0D0D0D;
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .size-btn:hover {
      border-color: #A8E63D;
      background: rgba(168, 230, 61, 0.1);
    }

    .size-modal-buttons {
      display: flex;
      gap: 12px;
      margin-top: 16px;
    }

    .size-modal-buttons button {
      flex: 1;
      padding: 12px;
      border-radius: 12px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .cancel-btn {
      background: #333;
      color: white;
    }

    .confirm-btn {
      background: #A8E63D;
      color: #0D0D0D;
    }

    @media (max-width: 360px) {
      .dish-name {
        font-size: 14px;
      }

      .dish-price {
        font-size: 13px;
      }

      .meta-info {
        font-size: 10px;
      }

      .food-card {
        padding: 12px;
      }
    }
  </style>
</head>
<body class="h-full">
  <div class="app-wrapper">
    <div class="phone-frame">
      <div class="phone-content hide-scrollbar" id="mainContent">

        <!-- Offer Banner -->
        <div class="bg-gradient-to-r from-amber-500 via-orange-500 to-red-500 py-2 overflow-hidden mt-0">
          <div class="marquee-text whitespace-nowrap text-white text-xs sm:text-sm font-medium">
            üî• FLAT 20% OFF on orders above ‚Çπ599! Use code: SPICE20 | üöö FREE Delivery above ‚Çπ499 | üÜï New items added! Try our Chef's Special Biryani!
          </div>
        </div>

        <!-- Hero Section -->
        <div class="p-3 sm:p-4">
          <div class="relative rounded-3xl overflow-hidden h-32 sm:h-40 mb-4" style="background: linear-gradient(135deg, rgba(168,230,61,0.2) 0%, rgba(13,13,13,0.9) 100%), linear-gradient(45deg, #1a1a1a, #2a2a2a);">
            <div class="absolute inset-0 flex items-center justify-between p-4 sm:p-6">
              <div>
                <p class="text-gray-400 text-xs sm:text-sm mb-1" id="timingDisplay">10 AM ‚Äì 11 PM</p>
                <h1 class="text-white text-lg sm:text-2xl font-bold leading-tight" id="greetingDisplay"> ZIXY BITE<br>RESTURANT üçΩ</h1>
              </div>
              <div class="text-4xl sm:text-6xl">üç≤</div>
            </div>
          </div>

          <!-- Search Bar -->
          <div class="relative mb-4">
            <input type="text" id="searchInput" placeholder="Search for dishes..." 
              class="w-full bg-[#1A1A1A] text-white rounded-2xl py-3 px-4 pl-10 text-xs sm:text-sm placeholder-gray-500 border border-gray-800 focus:border-[#A8E63D] transition-colors">
            <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 sm:w-5 sm:h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </div>

          <!-- Category Icons -->
          <div class="flex gap-2 sm:gap-4 overflow-x-auto hide-scrollbar pb-2 mb-4">
            <div class="flex flex-col items-center min-w-[50px] sm:min-w-[60px] cursor-pointer group" onclick="filterByCategory('all')">
              <div class="w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-[#1A1A1A] flex items-center justify-center text-xl sm:text-2xl mb-1 group-hover:bg-[#A8E63D] transition-colors">üçΩ</div>
              <span class="text-gray-400 text-xs">All</span>
            </div>
            <div class="flex flex-col items-center min-w-[50px] sm:min-w-[60px] cursor-pointer group" onclick="filterByCategory('starters')">
              <div class="w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-[#1A1A1A] flex items-center justify-center text-xl sm:text-2xl mb-1 group-hover:bg-[#A8E63D] transition-colors">ü•ü</div>
              <span class="text-gray-400 text-xs">Starters</span>
            </div>
            <div class="flex flex-col items-center min-w-[50px] sm:min-w-[60px] cursor-pointer group" onclick="filterByCategory('mains')">
              <div class="w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-[#1A1A1A] flex items-center justify-center text-xl sm:text-2xl mb-1 group-hover:bg-[#A8E63D] transition-colors">üçõ</div>
              <span class="text-gray-400 text-xs">Mains</span>
            </div>
            <div class="flex flex-col items-center min-w-[50px] sm:min-w-[60px] cursor-pointer group" onclick="filterByCategory('biryani')">
              <div class="w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-[#1A1A1A] flex items-center justify-center text-xl sm:text-2xl mb-1 group-hover:bg-[#A8E63D] transition-colors">üçö</div>
              <span class="text-gray-400 text-xs">Biryani</span>
            </div>
            <div class="flex flex-col items-center min-w-[50px] sm:min-w-[60px] cursor-pointer group" onclick="filterByCategory('breads')">
              <div class="w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-[#1A1A1A] flex items-center justify-center text-xl sm:text-2xl mb-1 group-hover:bg-[#A8E63D] transition-colors">ü´ì</div>
              <span class="text-gray-400 text-xs">Breads</span>
            </div>
            <div class="flex flex-col items-center min-w-[50px] sm:min-w-[60px] cursor-pointer group" onclick="filterByCategory('pizza')">
              <div class="w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-[#1A1A1A] flex items-center justify-center text-xl sm:text-2xl mb-1 group-hover:bg-[#A8E63D] transition-colors">üçï</div>
              <span class="text-gray-400 text-xs">Pizza</span>
            </div>
            <div class="flex flex-col items-center min-w-[50px] sm:min-w-[60px] cursor-pointer group" onclick="filterByCategory('noodles')">
              <div class="w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-[#1A1A1A] flex items-center justify-center text-xl sm:text-2xl mb-1 group-hover:bg-[#A8E63D] transition-colors">üçú</div>
              <span class="text-gray-400 text-xs">Noodles</span>
            </div>
            <div class="flex flex-col items-center min-w-[50px] sm:min-w-[60px] cursor-pointer group" onclick="filterByCategory('desserts')">
              <div class="w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-[#1A1A1A] flex items-center justify-center text-xl sm:text-2xl mb-1 group-hover:bg-[#A8E63D] transition-colors">üç®</div>
              <span class="text-gray-400 text-xs">Desserts</span>
            </div>
            <div class="flex flex-col items-center min-w-[50px] sm:min-w-[60px] cursor-pointer group" onclick="filterByCategory('drinks')">
              <div class="w-12 h-12 sm:w-14 sm:h-14 rounded-full bg-[#1A1A1A] flex items-center justify-center text-xl sm:text-2xl mb-1 group-hover:bg-[#A8E63D] transition-colors">ü•§</div>
              <span class="text-gray-400 text-xs">Drinks</span>
            </div>
          </div>

          <!-- Category Pills -->
          <div class="flex gap-2 overflow-x-auto hide-scrollbar pb-4" id="categoryPills">
            <button onclick="filterByCategory('all')" class="category-pill active px-4 py-2 sm:px-5 sm:py-2 rounded-full bg-[#1A1A1A] text-white text-xs sm:text-sm font-medium whitespace-nowrap">All</button>
            <button onclick="filterByCategory('starters')" class="category-pill px-4 py-2 sm:px-5 sm:py-2 rounded-full bg-[#1A1A1A] text-gray-400 text-xs sm:text-sm font-medium whitespace-nowrap">Starters</button>
            <button onclick="filterByCategory('mains')" class="category-pill px-4 py-2 sm:px-5 sm:py-2 rounded-full bg-[#1A1A1A] text-gray-400 text-xs sm:text-sm font-medium whitespace-nowrap">Mains</button>
            <button onclick="filterByCategory('biryani')" class="category-pill px-4 py-2 sm:px-5 sm:py-2 rounded-full bg-[#1A1A1A] text-gray-400 text-xs sm:text-sm font-medium whitespace-nowrap">Biryani</button>
            <button onclick="filterByCategory('breads')" class="category-pill px-4 py-2 sm:px-5 sm:py-2 rounded-full bg-[#1A1A1A] text-gray-400 text-xs sm:text-sm font-medium whitespace-nowrap">Breads</button>
            <button onclick="filterByCategory('pizza')" class="category-pill px-4 py-2 sm:px-5 sm:py-2 rounded-full bg-[#1A1A1A] text-gray-400 text-xs sm:text-sm font-medium whitespace-nowrap">Pizza</button>
            <button onclick="filterByCategory('noodles')" class="category-pill px-4 py-2 sm:px-5 sm:py-2 rounded-full bg-[#1A1A1A] text-gray-400 text-xs sm:text-sm font-medium whitespace-nowrap">Noodles</button>
            <button onclick="filterByCategory('desserts')" class="category-pill px-4 py-2 sm:px-5 sm:py-2 rounded-full bg-[#1A1A1A] text-gray-400 text-xs sm:text-sm font-medium whitespace-nowrap">Desserts</button>
            <button onclick="filterByCategory('drinks')" class="category-pill px-4 py-2 sm:px-5 sm:py-2 rounded-full bg-[#1A1A1A] text-gray-400 text-xs sm:text-sm font-medium whitespace-nowrap">Drinks</button>
          </div>

          <!-- Food Items Grid -->
          <div id="foodGrid" class="space-y-3 sm:space-y-4 px-0">
            <!-- Items rendered by JS -->
          </div>
        </div>

      </div>

      <!-- Bottom Cart Bar -->
      <div id="bottomBar" class="bottom-bar fixed bottom-0 left-0 right-0 bg-[#1A1A1A] border-t border-gray-800 p-3 sm:p-4 z-50 flex items-center justify-between">
        <div class="flex items-center gap-2 sm:gap-3 flex-1">
          <div class="relative">
            <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#A8E63D] flex items-center justify-center relative overflow-hidden flex-shrink-0">
              <svg class="w-5 h-5 sm:w-6 sm:h-6 text-[#0D0D0D]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
              </svg>
              <div id="cartThumbnailStack" class="cart-thumbnail-stack absolute inset-0 flex items-center justify-center" style="display: none;"></div>
            </div>
            <span id="cartCount" class="absolute -top-1 -right-1 w-4 h-4 sm:w-5 sm:h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold">0</span>
          </div>
          <div class="min-w-0">
            <p class="text-gray-400 text-xs">Total</p>
            <p class="text-white font-bold text-base sm:text-lg">‚Çπ<span id="cartTotal">0</span></p>
          </div>
        </div>
        <button onclick="openCart()" class="bg-[#A8E63D] text-[#0D0D0D] px-4 sm:px-6 py-2 sm:py-3 rounded-2xl font-semibold text-xs sm:text-sm hover:bg-[#9AD835] transition-colors flex-shrink-0">
          View Order ‚Üí
        </button>
      </div>

      <!-- Cart Sheet Backdrop -->
      <div id="cartBackdrop" class="backdrop fixed inset-0 bg-black/70 backdrop-blur-sm z-[60]" onclick="closeCart()"></div>

      <!-- Cart Sheet -->
      <div id="cartSheet" class="cart-sheet fixed bottom-0 left-0 right-0 bg-[#0D0D0D] rounded-t-3xl z-[70] max-h-[90%] overflow-hidden flex flex-col">
        <div class="p-4 border-b border-gray-800 flex-shrink-0">
          <div class="w-12 h-1 bg-gray-600 rounded-full mx-auto mb-4"></div>
          <div class="flex items-center justify-between">
            <h2 class="text-white text-lg sm:text-xl font-bold">Your Order</h2>
            <button onclick="closeCart()" class="w-8 h-8 rounded-full bg-[#1A1A1A] flex items-center justify-center text-gray-400 hover:text-white transition-colors">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>

        <div class="overflow-y-auto max-h-[calc(100vh-300px)] hide-scrollbar flex-1">
          <!-- Cart Items -->
          <div id="cartItems" class="p-4 space-y-3">
            <!-- Rendered by JS -->
          </div>

          <!-- Customer Details -->
          <div class="p-4 border-t border-gray-800">
            <h3 class="text-white font-semibold mb-3 text-sm sm:text-base">Delivery Details</h3>
            <div class="space-y-3">
              <input type="text" id="customerName" placeholder="Your Name *" 
                class="w-full bg-[#1A1A1A] text-white rounded-xl py-3 px-4 text-xs sm:text-sm placeholder-gray-500 border border-gray-800 focus:border-[#A8E63D] transition-colors">
              <input type="tel" id="customerPhone" placeholder="Phone Number *" 
                class="w-full bg-[#1A1A1A] text-white rounded-xl py-3 px-4 text-xs sm:text-sm placeholder-gray-500 border border-gray-800 focus:border-[#A8E63D] transition-colors">
              <textarea id="customerAddress" placeholder="Delivery Address *" rows="2"
                class="w-full bg-[#1A1A1A] text-white rounded-xl py-3 px-4 text-xs sm:text-sm placeholder-gray-500 border border-gray-800 focus:border-[#A8E63D] transition-colors resize-none"></textarea>
              
              <!-- Payment Method Section -->
              <div class="mt-4 pt-4 border-t border-gray-800">
                <h3 class="text-white font-semibold mb-3 text-sm">Payment Method</h3>
                <div class="space-y-2">
                  <button id="codBtn" onclick="selectPayment('cod')" class="payment-option w-full bg-[#1A1A1A] border-2 border-gray-700 hover:border-[#A8E63D] text-white rounded-xl py-3 px-4 text-xs sm:text-sm font-medium transition-all flex items-center justify-between">
                    <span>üíµ Cash on Delivery</span>
                    <span id="codCheck" class="text-[#A8E63D] opacity-0 transition-opacity">‚úì</span>
                  </button>
                  <button id="payBtn" onclick="selectPayment('online')" class="payment-option w-full bg-[#1A1A1A] border-2 border-gray-700 hover:border-[#A8E63D] text-white rounded-xl py-3 px-4 text-xs sm:text-sm font-medium transition-all flex items-center justify-between">
                    <span>üí≥ Pay Online (UPI)</span>
                    <span id="payCheck" class="text-[#A8E63D] opacity-0 transition-opacity">‚úì</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Price Breakdown & Checkout -->
        <div class="p-4 border-t border-gray-800 bg-[#1A1A1A] flex-shrink-0">
          <div class="space-y-2 mb-4">
            <div class="flex justify-between text-gray-400 text-xs sm:text-sm">
              <span>Subtotal</span>
              <span>‚Çπ<span id="subtotal">0</span></span>
            </div>
            <div class="flex justify-between text-gray-400 text-xs sm:text-sm">
              <span>Delivery</span>
              <span id="deliveryCharge">‚Çπ40</span>
            </div>
            <div class="flex justify-between text-white font-bold text-sm sm:text-lg pt-2 border-t border-gray-700">
              <span>Total</span>
              <span>‚Çπ<span id="grandTotal">0</span></span>
            </div>
          </div>
          <button id="checkoutBtn" onclick="checkout()" class="whatsapp-btn w-full py-3 sm:py-4 rounded-2xl text-white font-bold text-sm sm:text-base flex items-center justify-center gap-2">
            <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="currentColor" viewBox="0 0 24 24">
              <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
            </svg>
            <span id="checkoutBtnText">Order on WhatsApp</span>
          </button>
        </div>
      </div>

    </div>
  </div>

  <!-- Size Selection Modal -->
  <div id="sizeModal" class="size-modal" onclick="closeSizeModal(event)">
    <div class="size-modal-content" onclick="event.stopPropagation()">
      <h3 id="sizeModalTitle">Select Size</h3>
      <div id="sizeOptionsContainer" class="size-options-grid"></div>
      <div class="size-modal-buttons">
        <button class="cancel-btn" onclick="closeSizeModal()">Cancel</button>
        <button class="confirm-btn" onclick="confirmSize()">Add to Cart</button>
      </div>
    </div>
  </div>

  <!-- Barcode Modal -->
  <div id="barcodeModal" class="barcode-modal" onclick="closeBarcode(event)">
    <div class="barcode-content" onclick="event.stopPropagation()">
      <h2 class="text-white text-lg sm:text-xl font-bold mb-2">Scan to Pay</h2>
      <p class="text-gray-400 text-xs sm:text-sm mb-4">Order ID: <span id="orderId" class="text-[#A8E63D] font-bold">SPK001</span></p>
      <svg id="barcode"></svg>
      <p class="text-white text-sm font-semibold mt-4">Amount: ‚Çπ<span id="barcodeAmount">0</span></p>
      <div class="space-y-3 mt-4">
        <button onclick="initiateUPIPayment()" class="w-full bg-gradient-to-r from-orange-500 to-orange-600 text-white py-3 rounded-lg font-semibold text-sm hover:from-orange-600 hover:to-orange-700 transition-colors flex items-center justify-center gap-2">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
          </svg>
          üí≥ Pay via UPI
        </button>
        <button onclick="closeBarcode()" class="w-full bg-gray-700 text-white py-2 rounded-lg font-semibold text-sm hover:bg-gray-600 transition-colors">
          Back to Cart
        </button>
      </div>
    </div>
  </div>

  <!-- Payment Processing -->
  <div id="paymentProcessing" class="payment-processing">
    <div class="spinner"></div>
    <p class="text-white text-sm font-medium">Processing payment...</p>
    <p class="text-gray-400 text-xs">Opening UPI app...</p>
  </div>

  <!-- Toast Container -->
  <div id="toastContainer" class="fixed bottom-20 sm:bottom-24 left-1/2 -translate-x-1/2 z-[100] space-y-2 pointer-events-none px-4"></div>

  <!-- Success Overlay -->
  <div id="successOverlay" class="success-overlay" style="display: none;">
    <div style="position: relative;">
      <div class="success-pulse"></div>
      <div class="success-icon">‚úì</div>
    </div>
  </div>

  <script>
    const UPI_ID = "6386754482@pthdfc";
    
    const defaultConfig = {
      restaurant_name: 'SpiceCraft Kitchen',
      greeting_text: 'Let\'s Eat Healthy Food',
      whatsapp_number: '916386754482',
      location: 'Muneshwar Vihar Colony, Barabanki, UP 225001',
      timing: '10 AM ‚Äì 11 PM',
      background_color: '#0D0D0D',
      surface_color: '#1A1A1A',
      text_color: '#FFFFFF',
      accent_color: '#A8E63D',
      secondary_accent: '#F5C518'
    };

    let config = { ...defaultConfig };
    let selectedPayment = 'cod';
    let currentOrderData = null;
    let pendingSizeSelection = null;

    const SIZE_MULTIPLIERS = {
      'pizza': { '7 inch': 1.0, '8 inch': 1.3, '10 inch': 1.6 },
      'noodles': { 'Half Plate': 1.0, 'Full Plate': 1.5 }
    };

    function getPriceForSize(basePrice, category, size) {
      if (!size) return basePrice;
      const multipliers = SIZE_MULTIPLIERS[category];
      if (multipliers && multipliers[size]) {
        return Math.round(basePrice * multipliers[size]);
      }
      return basePrice;
    }

    const menuItems = [
      { id: 1, name: 'Paneer Tikka', price: 199, oldPrice: 249, category: 'starters', image: 'https://images.unsplash.com/photo-1599510120657-0e265ceea4d1?w=400&h=300&fit=crop', rating: 4.8, calories: 285, time: '20 min', tag: 'Popular', spicy: true },
      { id: 2, name: 'Crispy Veg Spring Rolls', price: 149, oldPrice: null, category: 'starters', image: 'https://images.unsplash.com/photo-1592078615290-033ee584e267?w=400&h=300&fit=crop', rating: 4.5, calories: 220, time: '15 min', tag: 'New', spicy: false },
      { id: 3, name: 'Chicken Seekh Kebab', price: 249, oldPrice: 299, category: 'starters', image: 'https://images.unsplash.com/photo-1566103412396-bda4a96e1f37?w=400&h=300&fit=crop', rating: 4.9, calories: 340, time: '25 min', tag: 'Popular', spicy: true },
      { id: 4, name: 'Mushroom Manchurian', price: 179, oldPrice: null, category: 'starters', image: 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400&h=300&fit=crop', rating: 4.6, calories: 265, time: '18 min', tag: null, spicy: false },
      { id: 5, name: 'Tandoori Chicken', price: 299, oldPrice: 349, category: 'starters', image: 'https://images.unsplash.com/photo-1598103442097-8b74394b95c6?w=400&h=300&fit=crop', rating: 4.9, calories: 380, time: '30 min', tag: 'Spicy', spicy: true },
      { id: 6, name: 'Butter Chicken', price: 329, oldPrice: 399, category: 'mains', image: 'https://images.unsplash.com/photo-1565557623814-dea706400c64?w=400&h=300&fit=crop', rating: 4.9, calories: 490, time: '35 min', tag: 'Popular', spicy: false },
      { id: 7, name: 'Paneer Butter Masala', price: 269, oldPrice: null, category: 'mains', image: 'https://images.unsplash.com/photo-1645112411341-6c4ee32510d8?w=400&h=300&fit=crop', rating: 4.7, calories: 420, time: '30 min', tag: null, spicy: false },
      { id: 8, name: 'Dal Makhani', price: 219, oldPrice: null, category: 'mains', image: 'https://images.unsplash.com/photo-1626200419401-a36cd95ee387?w=400&h=300&fit=crop', rating: 4.8, calories: 350, time: '25 min', tag: 'Popular', spicy: false },
      { id: 9, name: 'Chicken Curry', price: 289, oldPrice: 329, category: 'mains', image: 'https://images.unsplash.com/photo-1603452574291-e1b89bef42c0?w=400&h=300&fit=crop', rating: 4.6, calories: 410, time: '35 min', tag: null, spicy: true },
      { id: 10, name: 'Palak Paneer', price: 239, oldPrice: null, category: 'mains', image: 'https://images.unsplash.com/photo-1585238341710-4913dfb1d08b?w=400&h=300&fit=crop', rating: 4.5, calories: 320, time: '28 min', tag: 'Healthy', spicy: false },
      { id: 11, name: 'Mutton Rogan Josh', price: 399, oldPrice: 449, category: 'mains', image: 'https://images.unsplash.com/photo-1626200419401-a36cd95ee387?w=400&h=300&fit=crop', rating: 4.9, calories: 520, time: '45 min', tag: 'Special', spicy: true },
      { id: 12, name: 'Kadhai Paneer', price: 249, oldPrice: null, category: 'mains', image: 'https://images.unsplash.com/photo-1585238341710-4913dfb1d08b?w=400&h=300&fit=crop', rating: 4.7, calories: 380, time: '25 min', tag: null, spicy: true },
      { id: 13, name: 'Hyderabadi Chicken Biryani', price: 299, oldPrice: 349, category: 'biryani', image: 'https://images.unsplash.com/photo-1584584867912-14860b3cb34d?w=400&h=300&fit=crop', rating: 4.9, calories: 580, time: '40 min', tag: 'Popular', spicy: true },
      { id: 14, name: 'Veg Dum Biryani', price: 229, oldPrice: null, category: 'biryani', image: 'https://images.unsplash.com/photo-1589985643342-b7cf4b546f8c?w=400&h=300&fit=crop', rating: 4.6, calories: 450, time: '35 min', tag: null, spicy: false },
      { id: 15, name: 'Mutton Biryani', price: 379, oldPrice: 429, category: 'biryani', image: 'https://images.unsplash.com/photo-1584584867912-14860b3cb34d?w=400&h=300&fit=crop', rating: 4.9, calories: 620, time: '50 min', tag: 'Special', spicy: true },
      { id: 16, name: 'Egg Biryani', price: 249, oldPrice: null, category: 'biryani', image: 'https://images.unsplash.com/photo-1589985643342-b7cf4b546f8c?w=400&h=300&fit=crop', rating: 4.5, calories: 480, time: '35 min', tag: 'New', spicy: false },
      { id: 17, name: 'Paneer Biryani', price: 259, oldPrice: null, category: 'biryani', image: 'https://images.unsplash.com/photo-1584584867912-14860b3cb34d?w=400&h=300&fit=crop', rating: 4.7, calories: 510, time: '38 min', tag: null, spicy: false },
      { id: 18, name: 'Butter Naan', price: 49, oldPrice: null, category: 'breads', image: 'https://images.unsplash.com/photo-1585238341710-4913dfb1d08b?w=400&h=300&fit=crop', rating: 4.8, calories: 150, time: '8 min', tag: 'Popular', spicy: false },
      { id: 19, name: 'Garlic Naan', price: 59, oldPrice: null, category: 'breads', image: 'https://images.unsplash.com/photo-1601050690597-df0568f70950?w=400&h=300&fit=crop', rating: 4.9, calories: 165, time: '8 min', tag: 'Popular', spicy: false },
      { id: 20, name: 'Laccha Paratha', price: 55, oldPrice: null, category: 'breads', image: 'https://images.unsplash.com/photo-1565557623814-dea706400c64?w=400&h=300&fit=crop', rating: 4.6, calories: 180, time: '10 min', tag: null, spicy: false },
      { id: 21, name: 'Stuffed Kulcha', price: 69, oldPrice: 79, category: 'breads', image: 'https://images.unsplash.com/photo-1601050690597-df0568f70950?w=400&h=300&fit=crop', rating: 4.7, calories: 220, time: '12 min', tag: 'New', spicy: false },
      { id: 22, name: 'Margherita Pizza', price: 249, oldPrice: 299, category: 'pizza', image: 'https://images.unsplash.com/photo-1604068549290-dea0e4a305ca?w=400&h=300&fit=crop', rating: 4.8, calories: 350, time: '20 min', tag: 'Popular', spicy: false, sizes: ['7 inch', '8 inch', '10 inch'] },
      { id: 23, name: 'Pepperoni Pizza', price: 279, oldPrice: 329, category: 'pizza', image: 'https://images.unsplash.com/photo-1628840042765-356cda07f4ee?w=400&h=300&fit=crop', rating: 4.9, calories: 420, time: '22 min', tag: 'Popular', spicy: true, sizes: ['7 inch', '8 inch', '10 inch'] },
      { id: 24, name: 'Veggie Delight Pizza', price: 259, oldPrice: null, category: 'pizza', image: 'https://images.unsplash.com/photo-1514306688989-be7149c159d4?w=400&h=300&fit=crop', rating: 4.6, calories: 320, time: '20 min', tag: 'New', spicy: false, sizes: ['7 inch', '8 inch', '10 inch'] },
      { id: 25, name: 'BBQ Chicken Pizza', price: 299, oldPrice: null, category: 'pizza', image: 'https://images.unsplash.com/photo-1513689915372-e9d42b0645ba?w=400&h=300&fit=crop', rating: 4.7, calories: 410, time: '25 min', tag: 'Special', spicy: true, sizes: ['7 inch', '8 inch', '10 inch'] },
      { id: 26, name: 'Chow Mein', price: 149, oldPrice: 179, category: 'noodles', image: 'https://images.unsplash.com/photo-1569718733890-5aa4cdc6c4c5?w=400&h=300&fit=crop', rating: 4.7, calories: 280, time: '15 min', tag: null, spicy: false, sizes: ['Half Plate', 'Full Plate'] },
      { id: 27, name: 'Hakka Noodles', price: 159, oldPrice: null, category: 'noodles', image: 'https://images.unsplash.com/photo-1585521941534-80f20695aae0?w=400&h=300&fit=crop', rating: 4.8, calories: 300, time: '16 min', tag: 'Popular', spicy: false, sizes: ['Half Plate', 'Full Plate'] },
      { id: 28, name: 'Schezuan Noodles', price: 169, oldPrice: 199, category: 'noodles', image: 'https://images.unsplash.com/photo-1629521883842-e6bf93a34330?w=400&h=300&fit=crop', rating: 4.9, calories: 320, time: '17 min', tag: 'Spicy', spicy: true, sizes: ['Half Plate', 'Full Plate'] },
      { id: 29, name: 'Veg Noodles', price: 129, oldPrice: null, category: 'noodles', image: 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400&h=300&fit=crop', rating: 4.5, calories: 240, time: '14 min', tag: null, spicy: false, sizes: ['Half Plate', 'Full Plate'] },
      { id: 30, name: 'Gulab Jamun', price: 99, oldPrice: null, category: 'desserts', image: 'https://images.unsplash.com/photo-1585080155469-5a072bf1f30c?w=400&h=300&fit=crop', rating: 4.8, calories: 280, time: '5 min', tag: 'Popular', spicy: false },
      { id: 31, name: 'Rasmalai', price: 129, oldPrice: null, category: 'desserts', image: 'https://images.unsplash.com/photo-1432139555190-58524dae6a55?w=400&h=300&fit=crop', rating: 4.9, calories: 250, time: '5 min', tag: 'Special', spicy: false },
      { id: 32, name: 'Chocolate Brownie', price: 149, oldPrice: 179, category: 'desserts', image: 'https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?w=400&h=300&fit=crop', rating: 4.7, calories: 350, time: '10 min', tag: 'New', spicy: false },
      { id: 33, name: 'Kulfi', price: 89, oldPrice: null, category: 'desserts', image: 'https://images.unsplash.com/photo-1563805042-7684c019e1cb?w=400&h=300&fit=crop', rating: 4.6, calories: 200, time: '5 min', tag: null, spicy: false },
      { id: 34, name: 'Masala Chai', price: 39, oldPrice: null, category: 'drinks', image: 'https://images.unsplash.com/photo-1597318177304-eb5edd48df85?w=400&h=300&fit=crop', rating: 4.8, calories: 80, time: '5 min', tag: 'Popular', spicy: false },
      { id: 35, name: 'Mango Lassi', price: 79, oldPrice: null, category: 'drinks', image: 'https://images.unsplash.com/photo-1582209921212-f6e1141e3055?w=400&h=300&fit=crop', rating: 4.9, calories: 180, time: '5 min', tag: 'Popular', spicy: false },
      { id: 36, name: 'Fresh Lime Soda', price: 49, oldPrice: null, category: 'drinks', image: 'https://images.unsplash.com/photo-1550330328-fbe7c395d18c?w=400&h=300&fit=crop', rating: 4.5, calories: 60, time: '3 min', tag: null, spicy: false },
      { id: 37, name: 'Cold Coffee', price: 99, oldPrice: 119, category: 'drinks', image: 'https://images.unsplash.com/photo-1509042239860-f550ce710b93?w=400&h=300&fit=crop', rating: 4.7, calories: 220, time: '5 min', tag: 'New', spicy: false },
      { id: 38, name: 'Buttermilk', price: 45, oldPrice: null, category: 'drinks', image: 'https://images.unsplash.com/photo-1582209921212-f6e1141e3055?w=400&h=300&fit=crop', rating: 4.6, calories: 70, time: '3 min', tag: 'Healthy', spicy: false }
    ];

    let cart = JSON.parse(localStorage.getItem('spicecraft_cart')) || [];
    let currentCategory = 'all';
    let renderTimeout;

    function updateDisplay() {
      const timingEl = document.getElementById('timingDisplay');
      if (timingEl) {
        timingEl.textContent = config.timing || defaultConfig.timing;
      }
    }

    function renderStars(rating) {
      const fullStars = Math.floor(rating);
      let stars = '';
      for (let i = 0; i < 5; i++) {
        stars += i < fullStars ? '<span class="text-[#F5C518]">‚òÖ</span>' : '<span class="text-gray-600">‚òÖ</span>';
      }
      return stars;
    }

    function getTagColor(tag) {
      const colors = {
        'Popular': 'bg-[#A8E63D] text-[#0D0D0D]',
        'New': 'bg-blue-500 text-white',
        'Spicy': 'bg-red-500 text-white',
        'Special': 'bg-purple-500 text-white',
        'Healthy': 'bg-emerald-500 text-white'
      };
      return colors[tag] || 'bg-gray-600 text-white';
    }

    function createFoodCard(item, index) {
      const cartItem = cart.find(c => c.id === item.id);
      const qty = cartItem ? cartItem.qty : 0;

      const card = document.createElement('div');
      card.className = 'food-card bg-[#1A1A1A] rounded-3xl p-3 sm:p-4 flex gap-3 sm:gap-4 relative';
      card.style.animationDelay = `${index * 0.02}s`;
      card.dataset.itemId = item.id;

      let tagHTML = '';
      if (item.tag) {
        tagHTML = `<span class="absolute -top-1 -left-1 ${getTagColor(item.tag)} text-[9px] sm:text-[10px] font-semibold px-2 py-0.5 rounded-full">${item.tag}</span>`;
      }

      let qtyHTML = '';
      if (qty > 0) {
        qtyHTML = `
          <div class="qty-container" style="gap: 4px; padding: 2px 4px;">
            <button onclick="updateQty(${item.id}, -1)" class="qty-btn" style="width: 24px; height: 24px; font-size: 11px;">‚àí</button>
            <span class="qty-display" style="font-size: 12px; min-width: 18px;">${qty}</span>
            <button onclick="updateQty(${item.id}, 1)" class="qty-btn" style="width: 24px; height: 24px; font-size: 11px;">+</button>
          </div>
        `;
      } else {
        if (item.sizes) {
          qtyHTML = `
            <button onclick="openSizeModal(${item.id}, '${item.name}')" class="add-btn w-9 h-9 sm:w-10 sm:h-10 rounded-full bg-[#A8E63D] flex items-center justify-center text-[#0D0D0D] font-bold text-lg shadow-lg shadow-[#A8E63D]/30">+</button>
          `;
        } else {
          qtyHTML = `
            <button onclick="addToCart(${item.id})" class="add-btn w-9 h-9 sm:w-10 sm:h-10 rounded-full bg-[#A8E63D] flex items-center justify-center text-[#0D0D0D] font-bold text-lg shadow-lg shadow-[#A8E63D]/30">+</button>
          `;
        }
      }

      let priceHTML = `<span class="dish-price text-white">‚Çπ${item.price}</span>`;
      if (item.oldPrice) {
        priceHTML += `<span class="text-gray-500 text-xs line-through">‚Çπ${item.oldPrice}</span>`;
      }

      card.innerHTML = `
        <div class="relative min-w-[70px] sm:min-w-[90px] flex-shrink-0">
          <img src="${item.image}" alt="${item.name}" loading="lazy"
            class="w-[70px] h-[70px] sm:w-[90px] sm:h-[90px] rounded-full object-cover shadow-lg"
            onerror="this.style.background='linear-gradient(135deg, #A8E63D 0%, #7dc621 100%)'; this.alt='Image unavailable';">
          ${tagHTML}
        </div>
        <div class="flex-1 min-w-0">
          <h3 class="dish-name text-white mb-1 truncate">${item.name}</h3>
          <div class="flex items-center gap-1 rating-text mb-1 sm:mb-2">
            ${renderStars(item.rating)}
            <span class="text-gray-500 ml-0.5 sm:ml-1">${item.rating}</span>
          </div>
          <div class="flex items-center gap-1 sm:gap-3 meta-info text-gray-500 mb-1 sm:mb-2 flex-wrap">
            <span class="flex items-center gap-0.5">üî• ${item.calories}</span>
            <span class="flex items-center gap-0.5">‚è± ${item.time}</span>
            ${item.spicy ? '<span class="text-red-500">üå∂Ô∏è</span>' : ''}
          </div>
          <div class="flex items-center gap-2">
            ${priceHTML}
          </div>
        </div>
        <div class="absolute bottom-3 sm:bottom-4 right-3 sm:right-4 flex-shrink-0">
          ${qtyHTML}
        </div>
      `;

      return card;
    }

    function renderFoodItems(items) {
      const grid = document.getElementById('foodGrid');
      if (!grid) return;

      clearTimeout(renderTimeout);
      
      const fragment = document.createDocumentFragment();
      items.forEach((item, index) => {
        fragment.appendChild(createFoodCard(item, index));
      });

      grid.innerHTML = '';
      grid.appendChild(fragment);
    }

    function filterByCategory(category) {
      currentCategory = category;

      const pills = document.querySelectorAll('.category-pill');
      pills.forEach(pill => {
        pill.classList.remove('active');
        const pillText = pill.textContent.toLowerCase().replace(/\s/g, '');
        const categoryMatch = category === 'all' ? pill.textContent === 'All' : pillText === category;
        if (categoryMatch) {
          pill.classList.add('active');
        }
      });

      const searchTerm = document.getElementById('searchInput')?.value?.toLowerCase() || '';
      let filtered = menuItems;

      if (category !== 'all') {
        filtered = filtered.filter(item => item.category === category);
      }

      if (searchTerm) {
        filtered = filtered.filter(item =>
          item.name.toLowerCase().includes(searchTerm) ||
          item.category.toLowerCase().includes(searchTerm)
        );
      }

      renderFoodItems(filtered);
    }

    function openSizeModal(itemId, itemName) {
      const item = menuItems.find(m => m.id === itemId);
      if (!item || !item.sizes) return;

      pendingSizeSelection = { itemId, itemName, sizes: item.sizes };

      const modal = document.getElementById('sizeModal');
      const title = document.getElementById('sizeModalTitle');
      const container = document.getElementById('sizeOptionsContainer');

      title.textContent = `Select Size - ${itemName}`;
      container.innerHTML = '';

      item.sizes.forEach(size => {
        const btn = document.createElement('button');
        btn.className = 'size-btn';
        const finalPrice = getPriceForSize(item.price, item.category, size);
        const priceChange = finalPrice - item.price;
        const priceText = priceChange > 0 ? `+‚Çπ${priceChange}` : '';
        btn.textContent = `${size} ${priceText}`;
        btn.onclick = () => {
          document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('selected'));
          btn.classList.add('selected');
          pendingSizeSelection.selectedSize = size;
        };
        container.appendChild(btn);
      });

      modal.classList.add('open');
    }

    function closeSizeModal(event) {
      if (event && event.target.id !== 'sizeModal') return;
      const modal = document.getElementById('sizeModal');
      if (modal) modal.classList.remove('open');
      pendingSizeSelection = null;
    }

    function confirmSize() {
      if (!pendingSizeSelection || !pendingSizeSelection.selectedSize) {
        showToast('Please select a size! üìè');
        return;
      }

      addToCart(pendingSizeSelection.itemId, pendingSizeSelection.selectedSize);
      closeSizeModal();
    }

    function addToCart(id, size = null) {
      const item = menuItems.find(m => m.id === id);
      if (!item) return;

      const finalPrice = getPriceForSize(item.price, item.category, size);
      const existing = cart.find(c => c.id === id && c.size === (size || undefined));

      if (existing) {
        existing.qty++;
      } else {
        cart.push({ 
          id, 
          name: item.name, 
          price: finalPrice, 
          basePrice: item.price,
          category: item.category,
          qty: 1,
          size: size || undefined
        });
      }

      saveCart();
      updateCartUI();
      const sizeText = size ? ` (${size})` : '';
      showToast(`${item.name}${sizeText} added! üéâ`);
      filterByCategory(currentCategory);
    }

    function updateQty(id, delta) {
      const item = cart.find(c => c.id === id);
      if (!item) return;

      item.qty += delta;

      if (item.qty <= 0) {
        const removedName = menuItems.find(m => m.id === id)?.name;
        cart = cart.filter(c => c.id !== id);
        showToast(`${removedName || 'Item'} removed üóëÔ∏è`);
      }

      saveCart();
      updateCartUI();
      renderCartItems();
      filterByCategory(currentCategory);
    }

    function removeFromCart(id) {
      const item = cart.find(c => c.id === id);
      if (item) {
        cart = cart.filter(c => c.id !== id);
        showToast(`${item.name} removed üóëÔ∏è`);
        saveCart();
        updateCartUI();
        renderCartItems();
      }
    }

    function saveCart() {
      localStorage.setItem('spicecraft_cart', JSON.stringify(cart));
    }

    function updateCartUI() {
      const totalItems = cart.reduce((sum, item) => sum + item.qty, 0);
      const subtotal = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
      const delivery = subtotal >= 499 ? 0 : 40;
      const total = subtotal + delivery;

      const cartCountEl = document.getElementById('cartCount');
      if (cartCountEl) {
        cartCountEl.textContent = totalItems;
        cartCountEl.classList.remove('cart-bounce');
        void cartCountEl.offsetWidth;
        cartCountEl.classList.add('cart-bounce');
      }

      const stack = document.getElementById('cartThumbnailStack');
      if (stack && totalItems > 0) {
        stack.innerHTML = '';
        const visibleItems = cart.slice(0, 3);
        visibleItems.forEach((cartItem) => {
          const menuItem = menuItems.find(m => m.id === cartItem.id);
          if (menuItem) {
            const thumb = document.createElement('img');
            thumb.src = menuItem.image;
            thumb.className = 'cart-thumb';
            stack.appendChild(thumb);
          }
        });
        if (cart.length > 3) {
          const countDiv = document.createElement('div');
          countDiv.className = 'cart-thumb-count';
          countDiv.textContent = `+${cart.length - 3}`;
          stack.appendChild(countDiv);
        }
        stack.style.display = 'flex';
      } else if (stack) {
        stack.style.display = 'none';
      }

      const cartTotalEl = document.getElementById('cartTotal');
      if (cartTotalEl) cartTotalEl.textContent = total;

      const subtotalEl = document.getElementById('subtotal');
      if (subtotalEl) subtotalEl.textContent = subtotal;

      const deliveryEl = document.getElementById('deliveryCharge');
      if (deliveryEl) deliveryEl.textContent = subtotal >= 499 ? 'FREE üéâ' : '‚Çπ40';

      const grandTotalEl = document.getElementById('grandTotal');
      if (grandTotalEl) grandTotalEl.textContent = total;

      const bottomBar = document.getElementById('bottomBar');
      if (bottomBar) {
        if (totalItems > 0) {
          bottomBar.classList.add('visible');
        } else {
          bottomBar.classList.remove('visible');
        }
      }
    }

    function renderCartItems() {
      const container = document.getElementById('cartItems');
      if (!container) return;

      if (cart.length === 0) {
        container.innerHTML = `
          <div class="text-center py-10">
            <div class="text-5xl mb-3">üõí</div>
            <p class="text-gray-400 text-sm">Your cart is empty</p>
            <p class="text-gray-600 text-xs">Add some delicious items!</p>
          </div>
        `;
        return;
      }

      const fragment = document.createDocumentFragment();

      cart.forEach(item => {
        const menuItem = menuItems.find(m => m.id === item.id);
        const itemDiv = document.createElement('div');
        itemDiv.className = 'bg-[#1A1A1A] rounded-2xl p-3 flex items-center gap-3';
        const sizeText = item.size ? ` (${item.size})` : '';
        itemDiv.innerHTML = `
          <img src="${menuItem?.image}" alt="${item.name}" class="w-10 h-10 sm:w-12 sm:h-12 rounded-full object-cover flex-shrink-0" onerror="this.style.background='linear-gradient(135deg, #A8E63D 0%, #7dc621 100%)'">
          <div class="flex-1 min-w-0">
            <h4 class="text-white text-xs sm:text-sm font-medium truncate">${item.name}${sizeText}</h4>
            <p class="text-[#A8E63D] text-xs sm:text-sm font-semibold">‚Çπ${item.price * item.qty}</p>
          </div>
          <div class="qty-container" style="gap: 4px; padding: 2px 4px; flex-shrink-0;">
            <button onclick="updateQty(${item.id}, -1)" class="qty-btn" style="width: 22px; height: 22px; font-size: 10px;">‚àí</button>
            <span class="qty-display" style="font-size: 11px; min-width: 16px;">${item.qty}</span>
            <button onclick="updateQty(${item.id}, 1)" class="qty-btn" style="width: 22px; height: 22px; font-size: 10px;">+</button>
          </div>
          <button onclick="removeFromCart(${item.id})" class="w-7 h-7 sm:w-8 sm:h-8 rounded-full hover:bg-red-500/20 flex items-center justify-center text-gray-500 hover:text-red-500 transition-colors flex-shrink-0">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
            </svg>
          </button>
        `;
        fragment.appendChild(itemDiv);
      });

      container.innerHTML = '';
      container.appendChild(fragment);
    }

    function selectPayment(method) {
      selectedPayment = method;
      
      const codBtn = document.getElementById('codBtn');
      const payBtn = document.getElementById('payBtn');
      const codCheck = document.getElementById('codCheck');
      const payCheck = document.getElementById('payCheck');
      const checkoutBtnText = document.getElementById('checkoutBtnText');
      
      if (method === 'cod') {
        codBtn.classList.add('selected');
        payBtn.classList.remove('selected');
        codCheck.classList.remove('opacity-0');
        payCheck.classList.add('opacity-0');
        if (checkoutBtnText) checkoutBtnText.textContent = 'Order on WhatsApp';
      } else {
        payBtn.classList.add('selected');
        codBtn.classList.remove('selected');
        payCheck.classList.remove('opacity-0');
        codCheck.classList.add('opacity-0');
        if (checkoutBtnText) checkoutBtnText.textContent = 'Pay Online';
      }
    }

    function openCart() {
      renderCartItems();
      const backdrop = document.getElementById('cartBackdrop');
      const sheet = document.getElementById('cartSheet');
      if (backdrop) backdrop.classList.add('open');
      if (sheet) sheet.classList.add('open');
    }

    function closeCart() {
      const backdrop = document.getElementById('cartBackdrop');
      const sheet = document.getElementById('cartSheet');
      if (backdrop) backdrop.classList.remove('open');
      if (sheet) sheet.classList.remove('open');
    }

    function showToast(message) {
      const container = document.getElementById('toastContainer');
      if (!container) return;

      const toast = document.createElement('div');
      toast.className = 'toast bg-[#1A1A1A] text-white px-3 sm:px-4 py-2 sm:py-3 rounded-xl text-xs sm:text-sm font-medium shadow-lg border border-gray-800';
      toast.textContent = message;
      container.appendChild(toast);

      setTimeout(() => toast.remove(), 3000);
    }

    function showSuccessAnimation() {
      const overlay = document.getElementById('successOverlay');
      if (overlay) {
        overlay.style.display = 'flex';
        setTimeout(() => {
          overlay.style.display = 'none';
        }, 1200);
      }
    }

    function saveCustomerData() {
      const nameInput = document.getElementById('customerName');
      const phoneInput = document.getElementById('customerPhone');
      const addressInput = document.getElementById('customerAddress');

      const name = nameInput?.value?.trim() || '';
      const phone = phoneInput?.value?.trim() || '';
      const address = addressInput?.value?.trim() || '';

      if (name) localStorage.setItem('spicecraft_customer_name', name);
      if (phone) localStorage.setItem('spicecraft_customer_phone', phone);
      if (address) localStorage.setItem('spicecraft_customer_address', address);

      currentOrderData = { name, phone, address };
    }

    function loadCustomerData() {
      const nameInput = document.getElementById('customerName');
      const phoneInput = document.getElementById('customerPhone');
      const addressInput = document.getElementById('customerAddress');

      const savedName = localStorage.getItem('spicecraft_customer_name') || '';
      const savedPhone = localStorage.getItem('spicecraft_customer_phone') || '';
      const savedAddress = localStorage.getItem('spicecraft_customer_address') || '';

      if (nameInput) nameInput.value = savedName;
      if (phoneInput) phoneInput.value = savedPhone;
      if (addressInput) addressInput.value = savedAddress;
    }

    function buildOrderMessage(paymentStatus = 'cod') {
      const subtotal = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
      const delivery = subtotal >= 499 ? 0 : 40;
      const total = subtotal + delivery;

      let message = `üçΩÔ∏è *NEW ORDER FROM SPICECRAFT* üçΩÔ∏è\n\n`;
      message += `üì¶ *ORDER DETAILS*\n`;
      message += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;

      cart.forEach(item => {
        const sizeText = item.size ? ` (${item.size})` : '';
        message += `${item.qty}x ${item.name}${sizeText} ‚Äì ‚Çπ${item.price}\n`;
      });

      message += `\nüí∞ *PRICING*\n`;
      message += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
      message += `Subtotal: ‚Çπ${subtotal}\n`;
      message += `Delivery: ${delivery === 0 ? 'FREE üéâ' : '‚Çπ' + delivery}\n`;
      message += `Total: ‚Çπ${total}\n`;

      message += `\nüë§ *CUSTOMER INFO*\n`;
      message += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
      message += `Name: ${currentOrderData?.name || 'N/A'}\n`;
      message += `Phone: ${currentOrderData?.phone || 'N/A'}\n`;
      message += `Address: ${currentOrderData?.address || 'N/A'}\n`;

      message += `\nüí≥ *PAYMENT STATUS*\n`;
      message += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
      message += paymentStatus === 'paid' ? `‚úÖ Online Payment Done\n` : `üíµ Cash on Delivery\n`;

      message += `\n${paymentStatus === 'paid' ? '‚úÖ PAYMENT CONFIRMED' : 'Awaiting COD Payment'}`;

      return message;
    }

    function showBarcode() {
      const subtotal = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
      const delivery = subtotal >= 499 ? 0 : 40;
      const total = subtotal + delivery;
      const orderId = 'SPK' + String(Math.floor(Math.random() * 10000)).padStart(5, '0');
      
      document.getElementById('orderId').textContent = orderId;
      document.getElementById('barcodeAmount').textContent = total;
      
      JsBarcode("#barcode", orderId, {
        format: "CODE128",
        width: 2,
        height: 100,
        displayValue: false
      });
      
      const modal = document.getElementById('barcodeModal');
      if (modal) modal.classList.add('open');
    }

    function initiateUPIPayment() {
      const subtotal = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
      const delivery = subtotal >= 499 ? 0 : 40;
      const total = subtotal + delivery;

      saveCustomerData();

      const processing = document.getElementById('paymentProcessing');
      if (processing) processing.classList.add('show');

      const upiLink = `upi://pay?pa=${UPI_ID}&pn=SpiceCraft%20Kitchen&tn=Order%20Payment&am=${total}&cu=INR`;
      
      // Open UPI app
      window.location.href = upiLink;

      showToast('Opening payment app... üí≥');

      // Wait for user to complete/cancel payment, then send WhatsApp
      setTimeout(() => {
        if (processing) processing.classList.remove('show');
        
        showSuccessAnimation();

        // Build message with paid status
        const message = buildOrderMessage('paid');
        const encoded = encodeURIComponent(message);

        setTimeout(() => {
          // Auto-open WhatsApp and send message
          window.location.href = `https://wa.me/916386754482?text=${encoded}`;

          // Clear cart after a delay
          setTimeout(() => {
            cart = [];
            saveCart();
            updateCartUI();
            closeCart();
            closeBarcode();
            filterByCategory(currentCategory);

            const nameInput = document.getElementById('customerName');
            const phoneInput = document.getElementById('customerPhone');
            const addressInput = document.getElementById('customerAddress');

            if (nameInput) nameInput.value = '';
            if (phoneInput) phoneInput.value = '';
            if (addressInput) addressInput.value = '';

            showToast('Order sent successfully! üéâ');
          }, 1000);
        }, 800);
      }, 2500);
    }

    function closeBarcode(event) {
      if (event && event.target.id !== 'barcodeModal') return;
      const modal = document.getElementById('barcodeModal');
      if (modal) modal.classList.remove('open');
    }

    function checkout() {
      const nameInput = document.getElementById('customerName');
      const phoneInput = document.getElementById('customerPhone');
      const addressInput = document.getElementById('customerAddress');

      const name = nameInput?.value?.trim() || '';
      const phone = phoneInput?.value?.trim() || '';
      const address = addressInput?.value?.trim() || '';

      if (!name || !phone || !address) {
        showToast('Please fill all details! üìù');
        return;
      }

      if (cart.length === 0) {
        showToast('Cart empty! üõí');
        return;
      }

      saveCustomerData();

      if (selectedPayment === 'online') {
        showBarcode();
        return;
      }

      // COD - Send WhatsApp directly
      showSuccessAnimation();

      setTimeout(() => {
        const message = buildOrderMessage('cod');
        const encoded = encodeURIComponent(message);
        
        // Auto-open WhatsApp and send
        window.location.href = `https://wa.me/916386754482?text=${encoded}`;

        setTimeout(() => {
          cart = [];
          saveCart();
          updateCartUI();
          closeCart();
          filterByCategory(currentCategory);

          const nameInput = document.getElementById('customerName');
          const phoneInput = document.getElementById('customerPhone');
          const addressInput = document.getElementById('customerAddress');

          if (nameInput) nameInput.value = '';
          if (phoneInput) phoneInput.value = '';
          if (addressInput) addressInput.value = '';

          showToast('Order sent! üéâ');
        }, 1000);
      }, 800);
    }

    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
      searchInput.addEventListener('input', () => {
        filterByCategory(currentCategory);
      });
    }

    updateDisplay();
    filterByCategory('all');
    updateCartUI();
    selectPayment('cod');
    loadCustomerData();
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cf53cb2b3106ed7',t:'MTc3MTMzMDgwOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>